!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():t.ajaxform=e()}(this,function(){/**
 * @preserve
 * Author: http://mrhenry.be
 *
 * How to use:
 *
 * var Ajaxform = require('./ajaxform'),
 *     formContainer = $('.parent-of-form');
 *
 * new Ajaxform(formContainer);
 *
 * Be sure that the form_container only contains 1 form
 */
"use strict";function t(t,e){this.$element=t,this.$form=this.$element.find("form").first(),this.$token=$('<input type="hidden" name="token" value="'+e.token+'">'),this.busy=!1,this.callback=void 0!==e.callback&&$.isFunction(e.callback)?e.callback:function(){},this.init()}return $.fn.ajaxform=function(e){return this.each(function(){$.data(this,"ajaxform")||$.data(this,"ajaxform",new t($(this),e))})},t.prototype.init=function(){var t=this;t.$form.append(t.$token),t.$element.on("submit","form",$.proxy(this.onSubmit,this))},t.prototype.onSubmit=function(t){this.busy||(t.preventDefault(),this.busy=!0,this.$form.addClass("busy"),$.ajax({data:this.$form.serialize(),error:$.proxy(this.requestError,this),success:$.proxy(this.requestSuccess,this),type:this.$form.attr("method"),url:this.$form.attr("action")}))},t.prototype.requestSuccess=function(e){var i=this,s=t.cleanResponse(e),o=s.find("form").first();i.busy=!1,i.$form.removeClass("busy"),i.$form.replaceWith(o),i.$form=o,i.callback()},t.prototype.requestError=function(){window.alert("Oops, something went wrong. Please try again."),this.busy=!1,this.$form.removeClass("busy")},t.cleanResponse=function(t){var e=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi;return $("<div>").append(t.replace(e,""))},t});